<!DOCTYPE html>
<html lang="en-us">
  <head>



  
  
    
  
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F41GEVVR9Y"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F41GEVVR9Y');
</script>

  



<link rel="canonical" href="https://architect.proyectoomega.es/web/websockets/websockets101/" />


  <meta charset="utf-8" />
  <title>Websockets </title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="generator" content="Hugo 0.99.1" />
  <meta name="description" content="Websockets  - This a website for cloud architects to find usefull resources. Created by Juan Antonio Estival to help others with snipets of aws, gcp, terraform, static websties, react and others " />
  <meta name="keywords" content="gcloud,, react,, google, cloud, platform,, gcp,, remote, development,, juan, antonio, estival">
 
  
  
  <meta name="robots" content="noindex,nofollow">
  
  

  
  <link
    rel="stylesheet"
    href="https://architect.proyectoomega.es/plugins/bootstrap/bootstrap.min.css"
  />


  
  <link
    rel="stylesheet"
    href="https://architect.proyectoomega.es/plugins/themify-icons/themify-icons.css"
  />

  
  <link
    rel="icon"
    href="https://architect.proyectoomega.es/images/favicon.png"
    type="image/x-icon"
  />

  
  <link
    href="https://fonts.googleapis.com/css?family=Nunito:300,400,700&display=swap"
    rel="stylesheet"
  />

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.js"></script>

  <style>
    :root{
      --primary-color:#006385;
      --body-color:#d2e0ce;
      --text-color:#636363;
      --text-color-dark:#242738;
      --white-color:#ffffff;
      --light-color:#f8f9fa;
      --font-family:Nunito;
    }
  </style>

  
  
  <link href="https://architect.proyectoomega.es/css/style.min.css" rel="stylesheet" media="screen" />

  
  
  <script src="https://architect.proyectoomega.es/plugins/jquery/jquery-1.12.4.js"></script>

  
  <script src="https://architect.proyectoomega.es/plugins/jquery/jquery-ui.js"></script>

  
  <script src="https://architect.proyectoomega.es/plugins/bootstrap/bootstrap.min.js"></script>

  
  <script src="https://architect.proyectoomega.es/plugins/match-height/jquery.matchHeight-min.js"></script>

  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F41GEVVR9Y"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-F41GEVVR9Y', { 'anonymize_ip': false });
}
</script>
 
  
  

  
     
  <meta name="twitter:title" content="Websockets " />
  <meta
    name="twitter:description"
    content="Creating the socket server. Intro We are going to create an node express server for backend request. This server will have several funcions like serve websocket requests.
 Folder Structure  The root directory will contain:
 main node project that will be used for backend backend folder frontend folder (can contain their own node_modules folder for example if using react)  Install express package.  npm i express Install dotenv Instead of reading the variables from the OS operating system we will read them from a hidden file called ."
  />
    <meta property="og:title" content="Websockets " />
<meta property="og:description" content="Creating the socket server. Intro We are going to create an node express server for backend request. This server will have several funcions like serve websocket requests.
 Folder Structure  The root directory will contain:
 main node project that will be used for backend backend folder frontend folder (can contain their own node_modules folder for example if using react)  Install express package.  npm i express Install dotenv Instead of reading the variables from the OS operating system we will read them from a hidden file called ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://architect.proyectoomega.es/web/websockets/websockets101/" /><meta property="article:section" content="web" />
<meta property="article:published_time" content="2022-04-03T08:16:01+02:00" />
<meta property="article:modified_time" content="2022-04-03T08:16:01+02:00" />

 <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Websockets "/>
<meta name="twitter:description" content="Creating the socket server. Intro We are going to create an node express server for backend request. This server will have several funcions like serve websocket requests.
 Folder Structure  The root directory will contain:
 main node project that will be used for backend backend folder frontend folder (can contain their own node_modules folder for example if using react)  Install express package.  npm i express Install dotenv Instead of reading the variables from the OS operating system we will read them from a hidden file called ."/>



  
  

  <link rel="stylesheet" href="https://fonts.cdnfonts.com/css/vielkalahizo"><link rel="stylesheet" href="https://fonts.cdnfonts.com/css/uno"><link rel="stylesheet" href="https://fonts.cdnfonts.com/css/saltstar"><link rel="stylesheet" href="https://fonts.cdnfonts.com/css/jabore">

  <link rel="stylesheet" href="https://architect.proyectoomega.es/css/foo.css"><link rel="stylesheet" href="https://architect.proyectoomega.es/css/bar.css">
</head>



  <body>
    
    
    <header class="shadow-bottom sticky-top bg-white">
      <nav class="navbar navbar-expand-md navbar-light">
  <div class="container px-2 px-md-0">
    <a class="navbar-brand px-2" href="/">
      
      
      
      Solutions Architect Resources
      
    </a>
    <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation"
      aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse text-center" id="navigation">
      <ul class="navbar-nav ml-auto">
        
        
        <li class="nav-item">
          <a class="nav-link text-dark" href="https://architect.proyectoomega.es/">Home</a>
        </li>
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            blog
          </a>
          <div class="dropdown-menu">
            
            <a class="dropdown-item" href="https://architect.proyectoomega.es/blogcategory">Sample Blog Category</a>
            
          </div>
        </li>
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            building
          </a>
          <div class="dropdown-menu">
            
            <a class="dropdown-item" href="https://architect.proyectoomega.es/building">Building</a>
            
          </div>
        </li>
        
        
        
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-dark" href="#" role="button" data-toggle="dropdown"
            aria-haspopup="true" aria-expanded="false">
            links
          </a>
          <div class="dropdown-menu">
            
            <a class="dropdown-item" href="https://architect.proyectoomega.es/links">Links</a>
            
          </div>
        </li>
        
        
      </ul>
      
    </div>
  </div>
</nav>

    </header>
    
     


<section class="single section-sm pb-0">
  <div class="container">
    <div class="row">
      <div class="col-lg-3">
        <div class="sidebar">
          <a
            class="back-btn"
            href="/"
            aria-label="back"
          ></a>
          <ul class="list-styled">
                                 
 
<li
  data-nav-id="https://architect.proyectoomega.es/web/"
  title="Web"
  class="sidelist
  "
>
  <a href="https://architect.proyectoomega.es/web/">
    Web
  </a>
   
  <ul>
            
 
<li
  data-nav-id="https://architect.proyectoomega.es/web/websockets/websockets101/"
  title="Websockets "
  class="sidelist
  active"
>
  <a href="https://architect.proyectoomega.es/web/websockets/websockets101/">
    Websockets 
  </a>
   
</li>
           
 
<li
  data-nav-id="https://architect.proyectoomega.es/web/websockets/websocketshostgcp/"
  title="Websockets Host in GCP"
  class="sidelist
  "
>
  <a href="https://architect.proyectoomega.es/web/websockets/websocketshostgcp/">
    Websockets Host in GCP
  </a>
   
</li>
   
  </ul>
  
</li>
              
          </ul>
        </div>
      </div>
      <div class="col-lg-9">
        <div class="p-lg-5 p-4 bg-white" id="content">
          <h2 class="mb-5" id="title">Websockets </h2>
          
          <div class="content"><h1 id="creating-the-socket-server">Creating the socket server.</h1>
<h2 id="intro">Intro</h2>
<p>We are going to create an node express server for backend request. This server will have several funcions like serve websocket requests.</p>
<ol>
<li>Folder Structure</li>
</ol>
<p>The root directory will contain:</p>
<ul>
<li>main node project that will be used for backend</li>
<li>backend folder</li>
<li>frontend folder (can contain their own node_modules folder for example if using react)</li>
</ul>
<ol start="2">
<li>Install express package.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>npm i express
</span></span></code></pre></div><ol start="3">
<li>Install dotenv
Instead of reading the variables from the OS operating system we will read them from a hidden file called .env. The way to read them is the same through <strong>process.env</strong>
Example of reading</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">projectId</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">npm_config_PROJECT_ID</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">example</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">npm_config_EXAMPLE</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> ( <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">npm_config_PORT</span> <span style="color:#f92672">||</span> <span style="color:#ae81ff">3000</span> );
</span></span></code></pre></div><p>Install the package and creat a .env file</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>npm i dotenv
</span></span><span style="display:flex;"><span>touch .env
</span></span></code></pre></div><p>Edit the .env as follows</p>
<pre tabindex="0"><code>PPROJECT_ID = &#39;my project&#39;;
PORT = 8080
</code></pre><ol start="4">
<li>I will use ES syntax. With this sintax I will use import statatemvs vs require. To enable this sintax edit the package.json file with</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#e6db74">&#34;module&#34;</span><span style="color:#960050;background-color:#1e0010">,</span>
</span></span></code></pre></div><ol start="5">
<li>Some tools</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>npm i nodemon, colors, body-parser
</span></span></code></pre></div><ol start="6">
<li>
<p>routes folder
Will contain routes other than root for call the api.</p>
</li>
<li>
<p>Prepare socket.io to serve the websockets connections
Socket info <a href="https://socket.io/docs/v3/server-initialization/"
   title="here" 
   target="_blank" rel="nofollow noopener">
  here</a></p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>npm install socket.io
</span></span></code></pre></div><p>Import the libraries needed</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">createServer</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;http&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Server</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;socket.io&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">dirname</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;path&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">path</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;path&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">fileURLToPath</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;url&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">http</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;http&#39;</span>;
</span></span></code></pre></div><p>As global vars define</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">server</span>;
</span></span></code></pre></div><p>Create a function to start the server and call it from the code.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">startServer</span> () {
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">httpServer</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createServer</span>(<span style="color:#a6e22e">app</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">server</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">createServer</span>(<span style="color:#a6e22e">app</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">io</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Server</span>(<span style="color:#a6e22e">httpServer</span>, {})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#34;connection&#34;</span>, (<span style="color:#a6e22e">socket</span>) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Client connected [id=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]`</span>.<span style="color:#a6e22e">blue</span>.<span style="color:#a6e22e">bold</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">emit</span>(<span style="color:#e6db74">&#39;server_setup&#39;</span>, <span style="color:#e6db74">`Server connected [id=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]`</span>);
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">httpServer</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#a6e22e">PORT</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//routes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">__dirname</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">dirname</span>(<span style="color:#a6e22e">fileURLToPath</span>(<span style="color:#66d9ef">import</span>.<span style="color:#a6e22e">meta</span>.<span style="color:#a6e22e">url</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">sendFile</span>(<span style="color:#a6e22e">path</span>.<span style="color:#a6e22e">join</span>(<span style="color:#a6e22e">__dirname</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;/../index.html&#39;</span>));
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">`server runing in </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">NODE_ENV</span><span style="color:#e6db74">}</span><span style="color:#e6db74">mode on port </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">PORT</span><span style="color:#e6db74">}</span><span style="color:#e6db74">.`</span>.<span style="color:#a6e22e">yellow</span>.<span style="color:#a6e22e">bold</span>
</span></span><span style="display:flex;"><span>      )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="8">
<li>Create an index.html</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">http-equiv</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;X-UA-Compatible&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;IE=edge&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">title</span>&gt;Web Socokets Testing Page&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.socket.io/4.5.0/socket.io.min.js&#34;</span> <span style="color:#a6e22e">integrity</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sha384-7EyYLQZgWBi67fBtVxw60/OWl1kjsfrPFcaU0pp0nAh+i8FD068QogUvg85Ewy1k&#34;</span> <span style="color:#a6e22e">crossorigin</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;anonymous&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">p</span>&gt; Open the developer console of the browser to check the logs&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">socketio</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">io</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">socket</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">socketio</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;connection&#39;</span>, <span style="color:#66d9ef">function</span>() {      
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">socketio</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;server_setup&#39;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">data</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">data</span>);     
</span></span><span style="display:flex;"><span>        });   
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><ol start="9">
<li>Explanation
-&gt; The node server will serve an index.html file when the root is called
http://localhost:3000</li>
</ol>
<p>-&gt; Then the js script of the index.html file will try to open a socket with the server through</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">socket</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">socketio</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;connection&#39;</span>, <span style="color:#66d9ef">function</span>() {});
</span></span></code></pre></div><p>Note that the connection string can be whatever</p>
<p>-&gt; The server will react to that string with</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#34;connection&#34;</span>, (<span style="color:#a6e22e">socket</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Client connected [id=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]`</span>.<span style="color:#a6e22e">blue</span>.<span style="color:#a6e22e">bold</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">emit</span>(<span style="color:#e6db74">&#39;server_setup&#39;</span>, <span style="color:#e6db74">`Server connected [id=</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">socket</span>.<span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]`</span>);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>Note that emit is the response that the server will send to the browser.</p>
<p>-&gt; the browser will react to that messeage through</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">socketio</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;server_setup&#39;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">data</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">data</span>);     
</span></span><span style="display:flex;"><span>});   
</span></span></code></pre></div><h2 id="commit-id">Commit ID</h2>
<p>Chapter 1</p>
</div>
          
          <p class="post-meta border-bottom pb-3 mb-0 mt-3">
            Updated on 03 Apr 2022
          </p>
          <nav class="pagination mt-3">
            
                      
                     
                                             
                         
              
                                    
                         
                         
              
                                    
                         
                         
                         
                         
              
              
                                                 
              
                                    
              
                                    
                         
                         
              
                                    
              
                                    
                         
              
              
                                                 
                         
                         
                         
                         
                         
              
              
                                                 
                         
                         
                         
              
                                    
                         
              
              
                                                 
              
                                    
              
              
                                                 
              
              
                                      
                  
                     
              
                                    
              
                                      
              
                                      
              
                                                 
              
              
                
            <a
              class="nav nav-prev"
              href="https://architect.proyectoomega.es/web/"
              aria-label="Previous page"
              ><i class="ti-arrow-left mr-2"></i>
              <span class="d-none d-md-block">Web</span></a
            >
             
            <a
              class="nav nav-next"
              href="https://architect.proyectoomega.es/web/websockets/websocketshostgcp/"
              aria-label="Previous page"
            >
              <span class="d-none d-md-block">Websockets Host in GCP</span
              ><i class="ti-arrow-right ml-2"></i
            ></a>
            
          </nav>
        </div>
      </div>
    </div>
  </div>
</section>







    
<footer class="section pb-4">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-8 text-md-left text-center">
        <p class="mb-md-0 mb-4">Proyecto Omega</p>
      </div>
      <div class="col-md-4 text-md-right text-center">
        <ul class="list-inline">
          
        </ul>
      </div>
    </div>
  </div>
</footer>




<script src="https://architect.proyectoomega.es/js/script.min.js"></script>


  </body>
  
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5K6JCB8"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  </html>